{
	"name": "POSHistory_2019",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CSV_POS_2019",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSynapse_POSHistory",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(output(\n\t\tYEAR as short,\n\t\tHALF as string,\n\t\tQUARTER as string,\n\t\t{MONTH NAME} as string,\n\t\tBILLTO as string,\n\t\t{BILLTO NAME} as string,\n\t\t{POS APPROVE DATE} as date,\n\t\t{POS SALESMAN} as string,\n\t\t{AE Name} as string,\n\t\t{PROGRAM GROUP} as string,\n\t\t{PROGRAM LEVEL} as string,\n\t\t{POS TYPE} as string,\n\t\t{BUYING GROUP} as string,\n\t\t{POS CUST ID} as integer,\n\t\t{CUST CODE} as string,\n\t\t{POS CUST} as string,\n\t\t{POS CITY} as string,\n\t\t{POS STATE} as string,\n\t\t{BILL CUST NAME} as string,\n\t\t{BILL ADDR1} as string,\n\t\t{BILL ADDR2} as string,\n\t\t{BILL CITY} as string,\n\t\t{BILL ST} as string,\n\t\t{SHIP CUST NAME} as string,\n\t\t{SHIP CITY} as string,\n\t\t{SHIP ST} as string,\n\t\t{COMM CITY} as string,\n\t\t{COMM STATE} as string,\n\t\t{COMMISSION AE} as string,\n\t\t{COMMISSION AE NAME} as string,\n\t\tSUBGROUP as string,\n\t\t{SUBGRP DESCR} as string,\n\t\t{INVOICE NBR} as string,\n\t\t{SALE DATE} as date,\n\t\t{ITEM CATEGORY} as string,\n\t\t{ITEM CODE} as string,\n\t\t{MDSE Name} as string,\n\t\t{QTY SHIP} as short,\n\t\t{PRICE SHIP} as double,\n\t\t{EXT SHIP} as double,\n\t\tMSRP as double,\n\t\t{MSRP TOTAL} as double,\n\t\t{GUAR PCT} as double,\n\t\t{PROG GROUP} as string,\n\t\t{BUY GROUP} as string,\n\t\t{Q4 Prev Prog Level as of 11/1} as string,\n\t\t{Q1 Prog Level as of 2/1} as string,\n\t\t{Q2 Prog Level as of 5/1} as string,\n\t\t{Q3 Prog Level as of 8/1} as string,\n\t\t{Q4 Prog Level as of 11/1} as string,\n\t\t{Q4 Prev Min Cons Rebate} as double,\n\t\t{Q1 Min Cons Rebate} as double,\n\t\t{Q2 Min Cons Rebate} as string,\n\t\t{Q3 Min Cons Rebate} as string,\n\t\t{Q4 Min Cons Rebate} as string,\n\t\t{Q1 SILVER} as short,\n\t\t{Q1 GOLD} as short,\n\t\t{Q1 PLATINUM} as short,\n\t\t{Q1 PTS} as short,\n\t\t{Q1 TTL} as short,\n\t\t{Q1 LEVEL ACHEIVED} as string,\n\t\t{Q1 PAYOUT LEVEL} as string,\n\t\t{Q1 REBATE AMT} as short,\n\t\t{Q1 INSTANT} as short,\n\t\t{Q1 MANUAL} as short,\n\t\t{Q2 SILVER} as string,\n\t\t{Q2 GOLD} as string,\n\t\t{Q2 PLATINUM} as string,\n\t\t{Q2 PTS} as string,\n\t\t{Q2 TTL} as short,\n\t\t{Q2 LEVEL ACHEIVED} as string,\n\t\t{Q2 PAYOUT LEVEL} as string,\n\t\t{Q2 REBATE AMT} as string,\n\t\t{Q2 INSTANT} as string,\n\t\t{Q2 MANUAL} as string,\n\t\t{Q3 SILVER} as string,\n\t\t{Q3 GOLD} as string,\n\t\t{Q3 PLATINUM} as string,\n\t\t{Q3 PTS} as string,\n\t\t{Q3 TTL} as short,\n\t\t{Q3 LEVEL ACHEIVED} as string,\n\t\t{Q3 PAYOUT LEVEL} as string,\n\t\t{Q3 REBATE AMT} as string,\n\t\t{Q3 INSTANT} as string,\n\t\t{Q3 MANUAL} as string,\n\t\t{Q4 SILVER} as string,\n\t\t{Q4 GOLD} as string,\n\t\t{Q4 PLATINUM} as string,\n\t\t{Q4 PTS} as string,\n\t\t{Q4 TTL} as short,\n\t\t{Q4 LEVEL ACHEIVED} as string,\n\t\t{Q4 PAYOUT LEVEL} as string,\n\t\t{Q4 REBATE AMT} as string,\n\t\t{Q4 INSTANT} as string,\n\t\t{Q4 MANUAL} as string,\n\t\tREP as string,\n\t\t{REP NAME} as string,\n\t\tSPECIALTY as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource1 derive({QTY SHIP} = toInteger('QTY SHIP'),\n\t\t{PRICE SHIP} = toDecimal({PRICE SHIP}, 20, 2),\n\t\t{EXT SHIP} = toDecimal({EXT SHIP}, 20, 2),\n\t\tMSRP = toDecimal(MSRP, 20, 2),\n\t\t{MSRP TOTAL} = toDecimal({MSRP TOTAL}, 20, 2)) ~> DerivedColumn1\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tYEAR as string,\n\t\tHALF as string,\n\t\tQUARTER as string,\n\t\tMONTH_NAME as string,\n\t\tBILLTO as string,\n\t\tBILLTO_NAME as string,\n\t\tPOS_APPROVE_DATE as date,\n\t\tPOS_SALESMAN as string,\n\t\tAE_Name as string,\n\t\tPROGRAM_GROUP as string,\n\t\tPROGRAM_LEVEL as string,\n\t\tPOS_TYPE as string,\n\t\tBUYING_GROUP as string,\n\t\tPOS_CUST_ID as string,\n\t\tCUST_CODE as string,\n\t\tPOS_CUST as string,\n\t\tPOS_CITY as string,\n\t\tPOS_STATE as string,\n\t\tBILL_CUST_NAME as string,\n\t\tBILL_ADDR1 as string,\n\t\tBILL_ADDR2 as string,\n\t\tBILL_CITY as string,\n\t\tBILL_ST as string,\n\t\tSHIP_CUST_NAME as string,\n\t\tSHIP_CITY as string,\n\t\tSHIP_ST as string,\n\t\tCOMM_CITY as string,\n\t\tCOMM_STATE as string,\n\t\tCOMMISSION_AE as string,\n\t\tCOMMISSION_AE_NAME as string,\n\t\tSUBGROUP as string,\n\t\tSUBGRP_DESCR as string,\n\t\tINVOICE_NBR as string,\n\t\tSALE_DATE as date,\n\t\tITEM_CATEGORY as string,\n\t\tITEM_CODE as string,\n\t\tMDSE_Name as string,\n\t\tQTY_SHIP as integer,\n\t\tPRICE_SHIP as decimal(20,2),\n\t\tEXT_SHIP as decimal(20,2),\n\t\tMSRP as decimal(20,2),\n\t\tMSRP_TOTAL as decimal(20,2),\n\t\tGUAR_PCT as string,\n\t\tPROG_GROUP as string,\n\t\tBUY_GROUP as string,\n\t\tQ4_Prev_Prog_Level_as_of_11_1 as string,\n\t\tQ1_Prog_Level_as_of_2_1 as string,\n\t\tQ2_Prog_Level_as_of_5_1 as string,\n\t\tQ3_Prog_Level_as_of_8_1 as string,\n\t\tQ4_Prog_Level_as_of_11_1 as string,\n\t\tQ4_Prev_Min_Cons_Rebate as string,\n\t\tQ1_Min_Cons_Rebate as string,\n\t\tQ2_Min_Cons_Rebate as string,\n\t\tQ3_Min_Cons_Rebate as string,\n\t\tQ4_Min_Cons_Rebate as string,\n\t\tQ1_SILVER as string,\n\t\tQ1_GOLD as string,\n\t\tQ1_PLATINUM as string,\n\t\tQ1_PTS as string,\n\t\tQ1_TTL as string,\n\t\tQ1_LEVEL_ACHEIVED as string,\n\t\tQ1_PAYOUT_LEVEL as string,\n\t\tQ1_REBATE_AMT as string,\n\t\tQ1_INSTANT as string,\n\t\tQ1_MANUAL as string,\n\t\tQ2_SILVER as string,\n\t\tQ2_GOLD as string,\n\t\tQ2_PLATINUM as string,\n\t\tQ2_PTS as string,\n\t\tQ2_TTL as string,\n\t\tQ2_LEVEL_ACHEIVED as string,\n\t\tQ2_PAYOUT_LEVEL as string,\n\t\tQ2_REBATE_AMT as string,\n\t\tQ2_INSTANT as string,\n\t\tQ2_MANUAL as string,\n\t\tQ3_SILVER as string,\n\t\tQ3_GOLD as string,\n\t\tQ3_PLATINUM as string,\n\t\tQ3_PTS as string,\n\t\tQ3_TTL as string,\n\t\tQ3_LEVEL_ACHEIVED as string,\n\t\tQ3_PAYOUT_LEVEL as string,\n\t\tQ3_REBATE_AMT as string,\n\t\tQ3_INSTANT as string,\n\t\tQ3_MANUAL as string,\n\t\tQ4_SILVER as string,\n\t\tQ4_GOLD as string,\n\t\tQ4_PLATINUM as string,\n\t\tQ4_PTS as string,\n\t\tQ4_TTL as string,\n\t\tQ4_LEVEL_ACHEIVED as string,\n\t\tQ4_PAYOUT_LEVEL as string,\n\t\tQ4_REBATE_AMT as string,\n\t\tQ4_INSTANT as string,\n\t\tQ4_MANUAL as string,\n\t\tREP as string,\n\t\tREP_NAME as string,\n\t\tSPECIALTY as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tYEAR,\n\t\tHALF,\n\t\tQUARTER,\n\t\tMONTH_NAME = {MONTH NAME},\n\t\tBILLTO,\n\t\tBILLTO_NAME = {BILLTO NAME},\n\t\tPOS_APPROVE_DATE = {POS APPROVE DATE},\n\t\tPOS_SALESMAN = {POS SALESMAN},\n\t\tAE_Name = {POS SALESMAN},\n\t\tPROGRAM_GROUP = {PROGRAM GROUP},\n\t\tPROGRAM_LEVEL = {PROGRAM LEVEL},\n\t\tPOS_TYPE = {POS TYPE},\n\t\tBUYING_GROUP = {BUYING GROUP},\n\t\tPOS_CUST_ID = {POS CUST ID},\n\t\tCUST_CODE = {CUST CODE},\n\t\tPOS_CUST = {POS CUST},\n\t\tPOS_CITY = {POS CITY},\n\t\tPOS_STATE = {POS STATE},\n\t\tBILL_CUST_NAME = {BILL CUST NAME},\n\t\tBILL_ADDR1 = {BILL ADDR1},\n\t\tBILL_ADDR2 = {BILL ADDR2},\n\t\tBILL_CITY = {BILL CITY},\n\t\tBILL_ST = {BILL ST},\n\t\tSHIP_CUST_NAME = {SHIP CUST NAME},\n\t\tSHIP_CITY = {SHIP CITY},\n\t\tSHIP_ST = {SHIP ST},\n\t\tCOMM_CITY = {COMM CITY},\n\t\tCOMM_STATE = {COMM STATE},\n\t\tCOMMISSION_AE = {COMMISSION AE},\n\t\tCOMMISSION_AE_NAME = {COMMISSION AE NAME},\n\t\tSUBGROUP,\n\t\tSUBGRP_DESCR = {SUBGRP DESCR},\n\t\tINVOICE_NBR = {INVOICE NBR},\n\t\tSALE_DATE = {SALE DATE},\n\t\tITEM_CATEGORY = {ITEM CATEGORY},\n\t\tITEM_CODE = {ITEM CODE},\n\t\tMDSE_Name = {MDSE Name},\n\t\tQTY_SHIP = {QTY SHIP},\n\t\tPRICE_SHIP = {PRICE SHIP},\n\t\tEXT_SHIP = {EXT SHIP},\n\t\tMSRP,\n\t\tMSRP_TOTAL = {MSRP TOTAL},\n\t\tGUAR_PCT = {GUAR PCT},\n\t\tPROG_GROUP = {PROG GROUP},\n\t\tBUY_GROUP = {BUY GROUP},\n\t\tQ4_Prev_Prog_Level_as_of_11_1 = {Q4 Prev Prog Level as of 11/1},\n\t\tQ1_Prog_Level_as_of_2_1 = {Q1 Prog Level as of 2/1},\n\t\tQ2_Prog_Level_as_of_5_1 = {Q2 Prog Level as of 5/1},\n\t\tQ3_Prog_Level_as_of_8_1 = {Q3 Prog Level as of 8/1},\n\t\tQ4_Prog_Level_as_of_11_1 = {Q4 Prog Level as of 11/1},\n\t\tQ4_Prev_Min_Cons_Rebate = {Q4 Prev Min Cons Rebate},\n\t\tQ1_Min_Cons_Rebate = {Q1 Min Cons Rebate},\n\t\tQ2_Min_Cons_Rebate = {Q2 Min Cons Rebate},\n\t\tQ3_Min_Cons_Rebate = {Q3 Min Cons Rebate},\n\t\tQ4_Min_Cons_Rebate = {Q4 Min Cons Rebate},\n\t\tQ1_SILVER = {Q1 SILVER},\n\t\tQ1_GOLD = {Q1 GOLD},\n\t\tQ1_PLATINUM = {Q1 PLATINUM},\n\t\tQ1_PTS = {Q1 PTS},\n\t\tQ1_TTL = {Q1 TTL},\n\t\tQ1_LEVEL_ACHEIVED = {Q1 LEVEL ACHEIVED},\n\t\tQ1_PAYOUT_LEVEL = {Q1 PAYOUT LEVEL},\n\t\tQ1_REBATE_AMT = {Q1 REBATE AMT},\n\t\tQ1_INSTANT = {Q1 INSTANT},\n\t\tQ1_MANUAL = {Q1 MANUAL},\n\t\tQ2_SILVER = {Q2 SILVER},\n\t\tQ2_GOLD = {Q2 GOLD},\n\t\tQ2_PLATINUM = {Q2 PLATINUM},\n\t\tQ2_PTS = {Q2 PTS},\n\t\tQ2_TTL = {Q2 TTL},\n\t\tQ2_LEVEL_ACHEIVED = {Q2 LEVEL ACHEIVED},\n\t\tQ2_PAYOUT_LEVEL = {Q2 PAYOUT LEVEL},\n\t\tQ2_REBATE_AMT = {Q2 REBATE AMT},\n\t\tQ2_INSTANT = {Q2 INSTANT},\n\t\tQ2_MANUAL = {Q2 MANUAL},\n\t\tQ3_SILVER = {Q3 SILVER},\n\t\tQ3_GOLD = {Q3 GOLD},\n\t\tQ3_PLATINUM = {Q3 PLATINUM},\n\t\tQ3_PTS = {Q3 PTS},\n\t\tQ3_TTL = {Q3 TTL},\n\t\tQ3_LEVEL_ACHEIVED = {Q3 LEVEL ACHEIVED},\n\t\tQ3_PAYOUT_LEVEL = {Q3 PAYOUT LEVEL},\n\t\tQ3_REBATE_AMT = {Q3 REBATE AMT},\n\t\tQ3_INSTANT = {Q3 INSTANT},\n\t\tQ3_MANUAL = {Q3 MANUAL},\n\t\tQ4_SILVER = {Q4 SILVER},\n\t\tQ4_GOLD = {Q4 GOLD},\n\t\tQ4_PLATINUM = {Q4 PLATINUM},\n\t\tQ4_PTS = {Q4 PTS},\n\t\tQ4_TTL = {Q4 TTL},\n\t\tQ4_LEVEL_ACHEIVED = {Q4 LEVEL ACHEIVED},\n\t\tQ4_PAYOUT_LEVEL = {Q4 PAYOUT LEVEL},\n\t\tQ4_REBATE_AMT = {Q4 REBATE AMT},\n\t\tQ4_INSTANT = {Q4 INSTANT},\n\t\tQ4_MANUAL = {Q4 MANUAL},\n\t\tREP,\n\t\tREP_NAME = {REP NAME}\n\t)) ~> sink1"
		}
	}
}