{
	"name": "POSHistory_2012",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CSV_POS_2012",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSynapse_POSHistory",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(output(\n\t\tYEAR as short,\n\t\tHALF as string,\n\t\tQUARTER as string,\n\t\t{MONTH NAME} as string,\n\t\t{BILL TO NAME} as string,\n\t\t{POS APPROVE DATE} as date,\n\t\t{PROGRAM GROUP} as string,\n\t\t{PROGRAM LEVEL} as string,\n\t\t{BUYING GROUP} as string,\n\t\t{Cust Type} as string,\n\t\tAE as string,\n\t\t{AE NAME} as string,\n\t\t{POS CUST ID} as integer,\n\t\t{CUST CODE} as string,\n\t\t{POS CUST} as string,\n\t\t{POS CITY} as string,\n\t\tState as string,\n\t\t{BILL CUST NAME} as string,\n\t\t{BILL ADDR1} as string,\n\t\t{BILL ADDR2} as string,\n\t\t{BILL CITY} as string,\n\t\t{BILL ST} as string,\n\t\t{SHIP CUST NAME} as string,\n\t\t{SHIP CITY} as string,\n\t\t{SHIP ST} as string,\n\t\t{COMM CITY} as string,\n\t\t{COMM ST} as string,\n\t\t{COMM AE} as string,\n\t\t{COMM AE NAME} as string,\n\t\t{SALE DATE} as date,\n\t\t{ITEM CODE} as string,\n\t\t{ITEM NAME} as string,\n\t\tSize as string,\n\t\t{GA/CAD} as string,\n\t\tItem as string,\n\t\t{QTY SHIP} as short,\n\t\t{PRICE SHIP} as double,\n\t\t{EXT SHIP} as double,\n\t\tMSRP as double,\n\t\t{MSRP TTL} as double,\n\t\tSUBGROUP as string,\n\t\t{SUBGRP DESCR} as string,\n\t\tSILVER as short,\n\t\tGOLD as short,\n\t\tPLATINUM as short,\n\t\t{Q4 Prev Min Cons Rebate} as double,\n\t\t{Q1 Min Cons Rebate} as double,\n\t\t{Q2 Min Cons Rebate} as string,\n\t\t{Q3 Min Cons Rebate} as boolean,\n\t\t{Q4 Min Cons Rebate} as boolean,\n\t\t{Prog Group} as string,\n\t\t{Buy Group} as string,\n\t\t{Q4 Prev Prog Level as of 11/1} as string,\n\t\t{Q1 Prog Level as of 2/1} as string,\n\t\t{Q1 TTL PTS} as short,\n\t\t{Q1 LEVEL ACHVD} as string,\n\t\t{Q1 PAY LEVEL} as string,\n\t\t{Q1 Instant Paid} as short,\n\t\t{Q1 Manual} as short,\n\t\t{Q1 Final Payout} as short,\n\t\t{Q2 Program Level as of 5/1} as string,\n\t\t{Q2 TTL PTS} as string,\n\t\t{Q2 LEVEL ACHVD} as string,\n\t\t{Q2 LEVEL TO PAY} as string,\n\t\t{Q2 INSTANT} as string,\n\t\t{Q2 MANUAL} as string,\n\t\t{Q2 PAYOUT} as string,\n\t\t{Q3 Program Level as of 8/1} as string,\n\t\t{Q3 TTL PTS} as string,\n\t\t{Q3 LEVEL ACHVD} as string,\n\t\t{Q3 LEVEL TO PAY} as string,\n\t\t{Q3 INSTANT} as string,\n\t\t{Q3 MANUAL} as string,\n\t\t{Q3 PAYOUT} as string,\n\t\t{Q4 Prog Level as of 11/1} as string,\n\t\t{Q4 TTL PTS} as string,\n\t\t{Q4 LEVEL ACHVD} as string,\n\t\t{Q4 LEVEL TO PAY} as string,\n\t\t{Q4 INSTANT} as string,\n\t\t{Q4 MANUAL} as string,\n\t\t{Q4 PAYOUT} as string,\n\t\tREP as string,\n\t\t{REP NAME} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource1 derive({QTY SHIP} = toInteger('QTY SHIP'),\n\t\t{PRICE SHIP} = toDecimal({PRICE SHIP}, 20, 2),\n\t\t{EXT SHIP} = toDecimal({EXT SHIP}, 20, 2),\n\t\tMSRP = toDecimal({MSRP}, 20, 2),\n\t\t{MSRP TTL} = toDecimal({MSRP TTL}, 20, 2)) ~> DerivedColumn1\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tYEAR as string,\n\t\tHALF as string,\n\t\tQUARTER as string,\n\t\tMONTH_NAME as string,\n\t\tBILLTO as string,\n\t\tBILLTO_NAME as string,\n\t\tPOS_APPROVE_DATE as date,\n\t\tPOS_SALESMAN as string,\n\t\tAE_Name as string,\n\t\tPROGRAM_GROUP as string,\n\t\tPROGRAM_LEVEL as string,\n\t\tPOS_TYPE as string,\n\t\tBUYING_GROUP as string,\n\t\tPOS_CUST_ID as string,\n\t\tCUST_CODE as string,\n\t\tPOS_CUST as string,\n\t\tPOS_CITY as string,\n\t\tPOS_STATE as string,\n\t\tBILL_CUST_NAME as string,\n\t\tBILL_ADDR1 as string,\n\t\tBILL_ADDR2 as string,\n\t\tBILL_CITY as string,\n\t\tBILL_ST as string,\n\t\tSHIP_CUST_NAME as string,\n\t\tSHIP_CITY as string,\n\t\tSHIP_ST as string,\n\t\tCOMM_CITY as string,\n\t\tCOMM_STATE as string,\n\t\tCOMMISSION_AE as string,\n\t\tCOMMISSION_AE_NAME as string,\n\t\tSUBGROUP as string,\n\t\tSUBGRP_DESCR as string,\n\t\tINVOICE_NBR as string,\n\t\tSALE_DATE as date,\n\t\tITEM_CATEGORY as string,\n\t\tITEM_CODE as string,\n\t\tMDSE_Name as string,\n\t\tQTY_SHIP as integer,\n\t\tPRICE_SHIP as decimal(20,2),\n\t\tEXT_SHIP as decimal(20,2),\n\t\tMSRP as decimal(20,2),\n\t\tMSRP_TOTAL as decimal(20,2),\n\t\tGUAR_PCT as string,\n\t\tPROG_GROUP as string,\n\t\tBUY_GROUP as string,\n\t\tQ4_Prev_Prog_Level_as_of_11_1 as string,\n\t\tQ1_Prog_Level_as_of_2_1 as string,\n\t\tQ2_Prog_Level_as_of_5_1 as string,\n\t\tQ3_Prog_Level_as_of_8_1 as string,\n\t\tQ4_Prog_Level_as_of_11_1 as string,\n\t\tQ4_Prev_Min_Cons_Rebate as string,\n\t\tQ1_Min_Cons_Rebate as string,\n\t\tQ2_Min_Cons_Rebate as string,\n\t\tQ3_Min_Cons_Rebate as string,\n\t\tQ4_Min_Cons_Rebate as string,\n\t\tQ1_SILVER as string,\n\t\tQ1_GOLD as string,\n\t\tQ1_PLATINUM as string,\n\t\tQ1_PTS as string,\n\t\tQ1_TTL as string,\n\t\tQ1_LEVEL_ACHEIVED as string,\n\t\tQ1_PAYOUT_LEVEL as string,\n\t\tQ1_REBATE_AMT as string,\n\t\tQ1_INSTANT as string,\n\t\tQ1_MANUAL as string,\n\t\tQ2_SILVER as string,\n\t\tQ2_GOLD as string,\n\t\tQ2_PLATINUM as string,\n\t\tQ2_PTS as string,\n\t\tQ2_TTL as string,\n\t\tQ2_LEVEL_ACHEIVED as string,\n\t\tQ2_PAYOUT_LEVEL as string,\n\t\tQ2_REBATE_AMT as string,\n\t\tQ2_INSTANT as string,\n\t\tQ2_MANUAL as string,\n\t\tQ3_SILVER as string,\n\t\tQ3_GOLD as string,\n\t\tQ3_PLATINUM as string,\n\t\tQ3_PTS as string,\n\t\tQ3_TTL as string,\n\t\tQ3_LEVEL_ACHEIVED as string,\n\t\tQ3_PAYOUT_LEVEL as string,\n\t\tQ3_REBATE_AMT as string,\n\t\tQ3_INSTANT as string,\n\t\tQ3_MANUAL as string,\n\t\tQ4_SILVER as string,\n\t\tQ4_GOLD as string,\n\t\tQ4_PLATINUM as string,\n\t\tQ4_PTS as string,\n\t\tQ4_TTL as string,\n\t\tQ4_LEVEL_ACHEIVED as string,\n\t\tQ4_PAYOUT_LEVEL as string,\n\t\tQ4_REBATE_AMT as string,\n\t\tQ4_INSTANT as string,\n\t\tQ4_MANUAL as string,\n\t\tREP as string,\n\t\tREP_NAME as string,\n\t\tSPECIALTY as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tYEAR,\n\t\tHALF,\n\t\tQUARTER,\n\t\tMONTH_NAME = {MONTH NAME},\n\t\tBILLTO_NAME = {BILL TO NAME},\n\t\tPOS_APPROVE_DATE = {POS APPROVE DATE},\n\t\tPROGRAM_GROUP = {PROGRAM GROUP},\n\t\tPROGRAM_LEVEL = {PROGRAM LEVEL},\n\t\tBUYING_GROUP = {BUYING GROUP},\n\t\tAE_Name = {AE NAME},\n\t\tPOS_CUST_ID = {POS CUST ID},\n\t\tCUST_CODE = {CUST CODE},\n\t\tPOS_CUST = {POS CUST},\n\t\tPOS_CITY = {POS CITY},\n\t\tBILL_CUST_NAME = {BILL CUST NAME},\n\t\tBILL_ADDR1 = {BILL ADDR1},\n\t\tBILL_ADDR2 = {BILL ADDR2},\n\t\tBILL_CITY = {BILL CITY},\n\t\tBILL_ST = {BILL ST},\n\t\tSHIP_CUST_NAME = {SHIP CUST NAME},\n\t\tSHIP_CITY = {SHIP CITY},\n\t\tCOMM_CITY = {COMM CITY},\n\t\tCOMM_STATE = {COMM ST},\n\t\tCOMMISSION_AE = {COMM AE},\n\t\tCOMMISSION_AE_NAME = {COMM AE NAME},\n\t\tSALE_DATE = {SALE DATE},\n\t\tITEM_CODE = {ITEM CODE},\n\t\tITEM_CATEGORY = {ITEM NAME},\n\t\tQTY_SHIP = {QTY SHIP},\n\t\tPRICE_SHIP = {PRICE SHIP},\n\t\tEXT_SHIP = {EXT SHIP},\n\t\tMSRP,\n\t\tMSRP_TOTAL = {MSRP TTL},\n\t\tSUBGROUP,\n\t\tSUBGRP_DESCR = {SUBGRP DESCR}\n\t)) ~> sink1"
		}
	}
}